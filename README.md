# API для управления банковскими картами

## Общее описание
RESTful сервис для работы с банковскими картами, пользователями и финансовыми операциями. Система разграничивает права доступа между администраторами и обычными пользователями.

## Авторизация
Для работы с защищенными endpoint-ами требуется JWT токен. Передавайте его в заголовке запроса:
```
Authorization: Bearer ваш_токен
```

## Базовый адрес
```
http://localhost:8080
```

## Доступные методы API

### Авторизация и регистрация
| Метод | Путь | Назначение | Доступ |
|-------|------|------------|---------|
| `POST` | `/api/auth/registration` | Создание нового аккаунта | Все |
| `POST` | `/api/auth/login` | Получение токена доступа | Все |
| `GET` | `/api/auth` | Страница регистрации | Все |

### Для пользователей
| Метод | Путь | Описание |
|-------|------|-----------|
| `GET` | `/user/cards` | Список карт пользователя |
| `GET` | `/user/balance` | Баланс по карте |
| `POST` | `/transfer` | Перевод средств |

### Для администраторов
| Метод | Путь | Назначение |
|-------|------|------------|
| `GET` | `/admin/cards` | Все карты системы |
| `GET` | `/admin/create_card` | Создание карты |
| `GET` | `/admin/{id}/user` | Данные пользователя |
| `PUT` | `/admin/{id}/assign` | Привязка карты |
| `PATCH` | `/admin/{id}/block` | Смена статуса карты |
| `DELETE` | `/admin/{id}/cards` | Удаление карты |

## Структуры данных

### Пользователь
```json
{
  "id": 123,
  "username": "ivanov",
  "password": "secret",
  "role": "USER"
}
```

### Банковская карта
```json
{
  "id": 456,
  "cardNumber": "1234567812345678",
  "expiredDate": "2025-12-31",
  "balance": 1500.50,
  "status": "ACTIVE"
}
```

### Запрос авторизации
```json
{
  "username": "ivanov",
  "password": "secret"
}
```

## Параметры запросов

### Настройки вывода
- `page` - страница (начальная: 0)
- `size` - количество записей (по умолчанию: 5)
- `searchingCard` - фильтр по номеру карты

### Статусы карт
- `ACTIVE` - действующая
- `BLOCKED` - заблокированная
- `EXPIRED` - истекшая

### Типы пользователей
- `ADMIN` - администратор системы
- `USER` - стандартный пользователь

## Примеры использования

### Создание пользователя
```bash
curl -X POST "http://localhost:8080/api/auth/registration" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "user",
    "password": "userpassword",
    "role": "USER"
  }'
```

### Создание администратора
```bash
curl -X POST "http://localhost:8080/api/auth/registration" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "adminpassword",
    "role": "ADMIN"
  }'
```

### Вход в систему
```bash
curl -X POST "http://localhost:8080/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "adminpassword"
  }'
```

### Работа с API
```bash
curl -X GET "http://localhost:8080/user/cards?page=0&size=5" \
  -H "Authorization: Bearer ваш_jwt_токен"
```

## Дополнительные возможности

### Интерактивная документация
Веб-интерфейс для тестирования API:
```
http://localhost:8080/swagger-ui.html
```

### Спецификация
Машиночитаемое описание API:
```
http://localhost:8080/v3/api-docs
```

## Особенности работы

- Администраторы может выпускать карты, удалять их, изменять статус (Блокировать, Активировать), назначать карту конкретному пользователю.
- Пользователи видят только свои карты и операции
- Переводы выполняются только между активными картами
- Срок действия токена - 24 часа

## Порядок использования:
- Необходимо создать пользователя
- Необходимо создать администратора и авторизоваться
- после авторизации нужно выпустить карту и назначить её конкретному пользователю.
---
